<!doctype html>
<html lang="en">
<head>
Â  <meta charset="utf-8" />
Â  <meta name="viewport" content="width=device-width,initial-scale=1" />
Â  <title>SharkTube â€“ Collapsible Flyout Portal</title>
Â  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
Â  <style>
Â  Â  :root{--w:960px;--menu-width:300px;--flyout-width:350px;--color-accent:#BEA876;--color-primary-bg:#283891;--color-bg-dark:#0b0d10;--color-text-white:#fff;--color-dark-hover:#3a4a9f}
Â  Â  body{margin:0;min-height:100vh;background:var(--color-bg-dark);color:var(--color-text-white);font-family:system-ui,sans-serif;display:flex;justify-content:center;align-items:flex-start;padding:20px}
Â  Â  .container{display:flex;width:calc(var(--w) + var(--menu-width) + var(--flyout-width) + 60px);max-width:100%;gap:20px;position:relative}
Â  Â  .content-area{flex-grow:1}
Â  Â  #sidebar{width:var(--menu-width);background:var(--color-primary-bg);border-radius:12px;padding:15px;box-shadow:0 4px 12px rgba(0,0,0,.3);max-height:calc(100vh - 40px);overflow-y:auto;position:relative;z-index:10}
Â  Â  #sidebar::-webkit-scrollbar{width:8px}
Â  Â  #sidebar::-webkit-scrollbar-track{background:var(--color-dark-hover);border-radius:4px}
Â  Â  #sidebar::-webkit-scrollbar-thumb{background:var(--color-accent);border-radius:4px}
Â  Â  #sidebar::-webkit-scrollbar-thumb:hover{background:#d4c090}
Â  Â  
    /* Simplified header: Contains no text or controls */
Â  Â  #sidebarHeader{display:flex;justify-content:flex-start;align-items:center;margin-bottom:15px}
Â  Â  
    /* Logo Image Styles */
    .logo-image {
        display: block;
        width: 100%;
        height: auto;
        border-radius: 8px;
        margin-bottom: 20px; /* Space between logo and teacher list */
    }

Â  Â  #loadingMessage{padding:10px;font-size:.9em}

Â  Â  .teacher-list,.category-list{list-style:none;padding:0;margin:0}
    /* Teacher Header Styles */
Â  Â  .teacher-header{
        font-weight:700;
        font-size:1.25em;
        color:var(--color-accent);
        padding:10px 5px 10px 30px; /* Increased padding-left for shark bullet */
        margin-top:10px;
        cursor:pointer;
        user-select:none;
        display:flex;
        justify-content:space-between;
        border-bottom:2px solid var(--color-dark-hover);
        position: relative; /* Needed for shark pseudo-element */
    }
    /* Shark Emoji Bullet Point (facing right) */
    .teacher-header::before {
        content: 'ğŸ¦ˆ';
        position: absolute;
        left: 5px;
        font-size: 1.1em;
        line-height: 1.25em;
    }
    /* Collapse/Expand indicator remains as '+' / '-' */
Â  Â  .teacher-header::after{content:'+';font-size:1.2em;transition:transform .3s}
Â  Â  .teacher-header.open::after{content:'-'}
    
    /* Category Header Styles */
Â  Â  .collapsible-header{padding:8px 5px;margin-bottom:5px;color:var(--color-text-white);font-size:.95em;cursor:pointer;user-select:none;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid var(--color-dark-hover);transition:background-color .2s;padding-left:25px}
Â  Â  .collapsible-header:hover{background-color:var(--color-dark-hover)}
Â  Â  .collapsible-header.active{background-color:var(--color-accent);color:var(--color-primary-bg)}
Â  Â  .collapsible-content{max-height:0;overflow:hidden;transition:max-height .4s ease-in-out}
    /* Flyout adjacent positioning confirmed */
Â  Â  #videoFlyout{
        position:absolute;
        top:0;
        left:calc(var(--menu-width) + 20px); 
        width:var(--flyout-width);
        background:var(--color-primary-bg);
        border-radius:12px;
        padding:15px;
        box-shadow:8px 8px 20px rgba(0,0,0,.5);
        max-height:calc(100vh - 40px);
        overflow-y:auto;
        display:none;
        z-index:20;
        opacity:0;
        transform:translateX(20px);
        transition:opacity .2s ease-out,transform .2s ease-out
    }
Â  Â  #videoFlyout.show{opacity:1;transform:translateX(0)}
Â  Â  #flyoutBreadcrumb{font-size:.85em;color:#aaa;font-weight:400;margin-bottom:5px;letter-spacing:.02em}
Â  Â  #flyoutHeader{font-size:1.3em;font-weight:700;color:var(--color-accent);margin-bottom:10px;padding-bottom:5px;border-bottom:1px solid var(--color-dark-hover);display:flex;justify-content:space-between;align-items:center}
Â  Â  #closeFlyoutBtn{background:none;border:none;color:var(--color-accent);font-size:1.5em;cursor:pointer;padding:0 5px;line-height:1;transition:color .2s}
Â  Â  #closeFlyoutBtn:hover{color:var(--color-text-white)}
Â  Â  .video-list{list-style:none;padding:0;margin:0}
Â  Â  .video-list li{padding:8px 10px;cursor:pointer;border-left:3px solid transparent;transition:background-color .2s,border-left-color .2s;font-size:.95em;line-height:1.3;white-space:normal;color:var(--color-text-white)}
Â  Â  .video-list li.selected{border-left-color:var(--color-accent);font-weight:700}
Â  Â  .video-list li:hover{background-color:var(--color-dark-hover)}
Â  Â  .wrap{position:relative;width:100%;max-width:var(--w);aspect-ratio:16/9;background:#000;border-radius:12px 12px 0 0;overflow:hidden;box-shadow:0 8px 24px rgba(0,0,0,.4)}
Â  Â  #player{width:100%;height:100%;pointer-events:none}
Â  Â  .controls{width:100%;max-width:var(--w);background:var(--color-primary-bg);padding:10px 15px;display:flex;align-items:center;gap:15px;box-shadow:0 8px 24px rgba(0,0,0,.4);border-radius:0 0 12px 12px;font-size:.9em}
Â  Â  #fullscreenBtn{background-color:var(--color-accent);color:var(--color-primary-bg);padding:5px 10px;border-radius:6px;font-weight:700;font-size:.9em;letter-spacing:.05em;text-transform:uppercase;transition:opacity .2s;flex-shrink:0;margin-left:auto}
Â  Â  #fullscreenBtn:hover{opacity:.9}
Â  Â  .btn{background:none;border:none;color:#fff;cursor:pointer;font-size:20px}
Â  Â  #seekRange{flex-grow:1}
Â  Â  input[type=range]{-webkit-appearance:none;appearance:none;height:5px;background:#555;cursor:pointer;border-radius:5px}
Â  Â  input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:15px;height:15px;border-radius:50%;background:var(--color-accent);cursor:pointer}
Â  Â  .finished{position:absolute;inset:0;display:grid;place-items:center;background:var(--color-bg-dark);text-align:center;padding:2rem}
Â  Â  .content-area:fullscreen{position:fixed;top:0;left:0;width:100vw;height:100vh;margin:0;padding:0;z-index:21;background-color:var(--color-bg-dark);display:flex;flex-direction:column;justify-content:center;align-items:center}
Â  Â  .content-area:fullscreen .wrap{width:100%;max-width:100%;flex-grow:1;max-height:calc(100vh - 60px);aspect-ratio:16/9;object-fit:contain;margin:auto;border-radius:0;box-shadow:none}
Â  Â  .content-area:fullscreen .controls{flex-shrink:0;border-radius:0;width:100%}
Â  Â  .content-area:fullscreen .finished{width:100%;height:100%;padding-top:50px}
Â  </style>
</head>
<body>
Â  <div class="container">
Â  Â  <!-- LEFT: Sidebar -->
Â  Â  <div id="sidebar">
Â  Â  Â  <div id="sidebarHeader">
          <!-- Empty for now -->
Â  Â  Â  </div>

      <!-- Logo Image locked to local file path (no fallback/placeholder) -->
      <img 
        src="sharkTube_full.png" 
        class="logo-image" 
        alt="SharkTube full logo graphic" 
      />

Â  Â  Â  <p id="loadingMessage">Loading videos...</p>
Â  Â  Â  <ul class="teacher-list" id="menuList" style="display:none"></ul>
Â  Â  </div>

Â  Â  <!-- MIDDLE: Flyout (Adjacent to Sidebar) -->
Â  Â  <div id="videoFlyout" style="display:none;">
Â  Â  Â  <div id="flyoutBreadcrumb"></div>
Â  Â  Â  <div id="flyoutHeader">
Â  Â  Â  Â  <span id="flyoutHeaderText">Videos in Category</span>
Â  Â  Â  Â  <button id="closeFlyoutBtn" title="Close Video List">â†</button>
Â  Â  Â  </div>
Â  Â  Â  <ul class="video-list" id="flyoutList"></ul>
Â  Â  </div>

Â  Â  <!-- RIGHT: Player & Controls (Position remains stable) -->
Â  Â  <div class="content-area">
Â  Â  Â  <div class="wrap">
Â  Â  Â  Â  <div id="player" referrerpolicy="strict-origin-when-cross-origin"></div>
Â  Â  Â  Â  <div class="finished" id="finished" style="display:none">
Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  <h2>All done.</h2>
Â  Â  Â  Â  Â  Â  <p>This video has ended. Click a title on the left to watch another.</p>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>
Â  Â  Â  <div class="controls" id="controls" style="display:none;">
Â  Â  Â  Â  <button class="btn" id="playPauseBtn">â–¶</button>
Â  Â  Â  Â  <span id="currentTimeSpan">0:00</span>
Â  Â  Â  Â  <input type="range" id="seekRange" min="0" max="100" value="0">
Â  Â  Â  Â  <span id="durationSpan">0:00</span>
Â  Â  Â  Â  <input type="range" id="volumeRange" min="0" max="100" value="100" style="width:80px;">
Â  Â  Â  Â  <button class="btn" id="fullscreenBtn" title="Toggle Fullscreen">FULLSCREEN</button>
Â  Â  Â  </div>
Â  Â  </div>
Â  </div>

Â  <!-- YouTube API (menu works even if this is blocked) -->
Â  <script src="https://www.youtube.com/iframe_api" referrerpolicy="strict-origin-when-cross-origin"></script>
Â  <script>
Â  Â  // -------------------- Config --------------------
Â  Â  const JSON_URL = './videos.json'; // local-only source of truth

Â  Â  // -------------------- State ---------------------
Â  Â  let VIDEO_DATA = [];
Â  Â  let player, updateTimer, isPlayerReady = false;
Â  Â  let activeCategoryHeader = null;
Â  Â  let pendingVideoId = null;

Â  Â  // -------------------- DOM -----------------------
Â  Â  const finishedEl = document.getElementById('finished');
Â  Â  const controlsEl = document.getElementById('controls');
Â  Â  const playPauseBtn = document.getElementById('playPauseBtn');
Â  Â  const seekRange = document.getElementById('seekRange');
Â  Â  const volumeRange = document.getElementById('volumeRange');
Â  Â  const menuListEl = document.getElementById('menuList');
Â  Â  const loadingMessageEl = document.getElementById('loadingMessage');
Â  Â  const flyoutEl = document.getElementById('videoFlyout');
Â  Â  const flyoutBreadcrumbEl = document.getElementById('flyoutBreadcrumb');
Â  Â  const flyoutHeaderTextEl = document.getElementById('flyoutHeaderText');
Â  Â  const flyoutListEl = document.getElementById('flyoutList');
Â  Â  const closeFlyoutBtn = document.getElementById('closeFlyoutBtn');
Â  Â  const currentTimeSpan = document.getElementById('currentTimeSpan');
Â  Â  const durationSpan = document.getElementById('durationSpan');
Â  Â  const fullscreenBtn = document.getElementById('fullscreenBtn');
Â  Â  const contentAreaEl = document.querySelector('.content-area');

Â  Â  // -------------------- Utils ---------------------
Â  Â  function formatTime(s){ if(isNaN(s)||s<0) return '0:00'; const m=Math.floor(s/60); const ss=String(Math.floor(s%60)).padStart(2,'0'); return `${m}:${ss}`; }

Â  Â  // -------------------- YouTube -------------------
Â  Â  window.onYouTubeIframeAPIReady = function () {
Â  Â  Â  isPlayerReady = true;
Â  Â  Â  const first = pendingVideoId || VIDEO_DATA[0]?.categories?.[0]?.videos?.[0]?.id;
Â  Â  Â  if (first) initializePlayer(first);
Â  Â  };

Â  Â  function initializePlayer(initialVideoId) {
Â  Â  Â  if (player) { try { player.destroy(); } catch {} if (updateTimer) clearInterval(updateTimer); }
Â  Â  Â  player = new YT.Player('player', {
Â  Â  Â  Â  videoId: initialVideoId,
Â  Â  Â  Â  host: 'https://www.youtube-nocookie.com',
Â  Â  Â  Â  playerVars: { controls:0, disablekb:1, rel:0, fs:0, iv_load_policy:3, modestbranding:1, playsinline:1, enablejsapi:1, origin: location.origin },
Â  Â  Â  Â  events: { onReady, onStateChange, onError: e => console.error('YouTube Player Error:', e.data) }
Â  Â  Â  });
Â  Â  }

Â  Â  function onReady(){
Â  Â  Â  controlsEl.style.display='flex';
Â  Â  Â  player.setVolume(100);
Â  Â  Â  durationSpan.textContent = formatTime(player.getDuration());
Â  Â  Â  playPauseBtn.addEventListener('click', togglePlayPause);
Â  Â  Â  volumeRange.addEventListener('input', () => player.setVolume(parseInt(volumeRange.value,10)));
Â  Â  Â  seekRange.addEventListener('change', () => {
Â  Â  Â  Â  const d = player.getDuration(); player.seekTo((seekRange.value/100)*d,true);
Â  Â  Â  Â  if (player.getPlayerState() !== YT.PlayerState.PLAYING){ player.playVideo(); playPauseBtn.textContent='â¸«'; }
Â  Â  Â  });
Â  Â  Â  fullscreenBtn.addEventListener('click', toggleFullscreen);
Â  Â  Â  document.addEventListener('fullscreenchange', handleFullscreenChange);
Â  Â  Â  if (updateTimer) clearInterval(updateTimer);
Â  Â  Â  updateTimer = setInterval(updatePlayerState, 1000);
Â  Â  Â  if (pendingVideoId) { player.cueVideoById(pendingVideoId); pendingVideoId=null; }
Â  Â  }

Â  Â  function onStateChange(e){
Â  Â  Â  if (e.data === YT.PlayerState.ENDED){
Â  Â  Â  Â  if (updateTimer) clearInterval(updateTimer);
Â  Â  Â  Â  try { player.cueVideoById(player.getVideoData().video_id); } catch {}
Â  Â  Â  Â  controlsEl.style.display='none'; finishedEl.style.display='grid';
Â  Â  Â  }
Â  Â  }
Â  Â  function updatePlayerState(){
Â  Â  Â  if (!(player && player.getPlayerState)) return;
Â  Â  Â  const state = player.getPlayerState(), t = player.getCurrentTime(), d = player.getDuration();
Â  Â  Â  currentTimeSpan.textContent = formatTime(t);
Â  Â  Â  if (d > 0 && durationSpan.textContent === '0:00') durationSpan.textContent = formatTime(d);
Â  Â  Â  if (state === YT.PlayerState.PLAYING){ seekRange.value = (t/d)*100; playPauseBtn.textContent='â¸«'; }
Â  Â  Â  else if (state === YT.PlayerState.PAUSED){ playPauseBtn.textContent='â–¶'; }
Â  Â  }
Â  Â  function togglePlayPause(){ const s = player.getPlayerState(); if (s===YT.PlayerState.PLAYING){ player.pauseVideo(); playPauseBtn.textContent='â–¶'; } else { player.playVideo(); playPauseBtn.textContent='â¸«'; } }
Â  Â  function toggleFullscreen(){ if (!document.fullscreenElement){ contentAreaEl.requestFullscreen?.().catch(err=>console.error('Fullscreen error:',err)); } else { document.exitFullscreen?.(); } }
Â  Â  function handleFullscreenChange(){ fullscreenBtn.textContent = document.fullscreenElement ? 'EXIT FULLSCREEN' : 'FULLSCREEN'; }

Â  Â  // -------------------- Data (local only) --------
Â  Â  async function loadLocalData(){
Â  Â  Â  menuListEl.style.display='none';
Â  Â  Â  flyoutEl.style.display='none';
Â  Â  Â  loadingMessageEl.style.display='block';
Â  Â  Â  loadingMessageEl.textContent='Loading videos...';

Â  Â  Â  try{
Â  Â  Â  Â  // cache-buster so we always pull the latest artifact written by Actions
Â  Â  Â  Â  const res = await fetch(`${JSON_URL}?t=${Date.now()}`, { cache:'no-store' });
Â  Â  Â  Â  if (!res.ok) throw new Error(`HTTP ${res.status}`);
Â  Â  Â  Â  const data = await res.json();
Â  Â  Â  Â  if (!Array.isArray(data) || !data.length) throw new Error('videos.json is empty or malformed');

Â  Â  Â  Â  VIDEO_DATA = data;
Â  Â  Â  Â  renderMenu();
Â  Â  Â  Â  loadingMessageEl.style.display='none';
Â  Â  Â  Â  menuListEl.style.display='block';

Â  Â  Â  Â  // Auto-open first teacher/category; init player if possible
Â  Â  Â  Â  const firstId = VIDEO_DATA[0]?.categories?.[0]?.videos?.[0]?.id;
Â  Â  Â  Â  pendingVideoId = firstId || null;
Â  Â  Â  Â  const firstTeacherHeader = menuListEl.querySelector('.teacher-header');
Â  Â  Â  Â  if (firstTeacherHeader){
Â  Â  Â  Â  Â  const firstTeacherContent = firstTeacherHeader.nextElementSibling;
Â  Â  Â  Â  Â  toggleCollapse(firstTeacherHeader, firstTeacherContent);
Â  Â  Â  Â  Â  const firstCategoryHeader = firstTeacherContent?.querySelector('.collapsible-header');
Â  Â  Â  Â  Â  if (firstCategoryHeader) handleCategoryClick({ currentTarget:firstCategoryHeader, stopPropagation(){ } });
Â  Â  Â  Â  }
Â  Â  Â  Â  if (isPlayerReady && firstId) initializePlayer(firstId);

Â  Â  Â  Â  // Soft notice if YouTube API is blocked
Â  Â  Â  Â  setTimeout(()=>{ if (!isPlayerReady) console.warn('YouTube API unavailable â€“ menu usable, player offline.'); }, 3000);
Â  Â  Â  }catch(err){
Â  Â  Â  Â  console.error('FATAL: failed to load videos.json', err);
Â  Â  Â  Â  loadingMessageEl.innerHTML = `<p style="color:#ff6b6b;font-weight:bold">Could not load videos.json</p><p>${err.message}</p>`;
Â  Â  Â  }
Â  Â  }

Â  Â  // -------------------- Menu ---------------------
Â  Â  function renderMenu(){
Â  Â  Â  menuListEl.innerHTML='';
Â  Â  Â  VIDEO_DATA.forEach(teacherItem=>{
Â  Â  Â  Â  const teacherHeader = document.createElement('div');
Â  Â  Â  Â  teacherHeader.className='teacher-header';
Â  Â  Â  Â  teacherHeader.textContent = teacherItem.teacher;

Â  Â  Â  Â  const teacherContent = document.createElement('div');
Â  Â  Â  Â  teacherContent.className='collapsible-content teacher-content';

Â  Â  Â  Â  const categoryUl = document.createElement('ul');
Â  Â  Â  Â  categoryUl.classList.add('category-list');

Â  Â  Â  Â  teacherItem.categories.forEach(categoryItem=>{
Â  Â  Â  Â  Â  const categoryHeader = document.createElement('div');
Â  Â  Â  Â  Â  categoryHeader.className='collapsible-header';
Â  Â  Â  Â  Â  categoryHeader.textContent = categoryItem.name;
Â  Â  Â  Â  Â  categoryHeader.dataset.videos = JSON.stringify(categoryItem.videos);
Â  Â  Â  Â  Â  categoryHeader.dataset.teacher = teacherItem.teacher;
Â  Â  Â  Â  Â  categoryHeader.addEventListener('click', handleCategoryClick);

Â  Â  Â  Â  Â  const li = document.createElement('li');
Â  Â  Â  Â  Â  li.appendChild(categoryHeader);
Â  Â  Â  Â  Â  categoryUl.appendChild(li);
Â  Â  Â  Â  });

Â  Â  Â  Â  teacherContent.appendChild(categoryUl);
Â  Â  Â  Â  teacherHeader.addEventListener('click', (e)=>{ toggleCollapse(teacherHeader, teacherContent); e.stopPropagation(); });

Â  Â  Â  Â  const teacherLi = document.createElement('li');
Â  Â  Â  Â  teacherLi.appendChild(teacherHeader);
Â  Â  Â  Â  teacherLi.appendChild(teacherContent);
Â  Â  Â  Â  menuListEl.appendChild(teacherLi);
Â  Â  Â  });
Â  Â  }

Â  Â  function toggleCollapse(headerEl, contentEl){
Â  Â  Â  if (!contentEl) return;
Â  Â  Â  const wasOpen = headerEl.classList.contains('open');
Â  Â  Â Â 
Â  Â  Â  // Auto-collapse all sibling teacher sections
Â  Â  Â  if (!wasOpen && headerEl.classList.contains('teacher-header')){
Â  Â  Â  Â  const allTeacherHeaders = menuListEl.querySelectorAll('.teacher-header.open');
Â  Â  Â  Â  allTeacherHeaders.forEach(th=>{
Â  Â  Â  Â  Â  if (th !== headerEl){
Â  Â  Â  Â  Â  Â  const tc = th.nextElementSibling;
Â  Â  Â  Â  Â  Â  if (tc){ tc.style.maxHeight='0'; th.classList.remove('open'); }
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  });
Â  Â  Â  }
Â  Â  Â Â 
Â  Â  Â  if (wasOpen){ contentEl.style.maxHeight='0'; headerEl.classList.remove('open'); }
Â  Â  Â  else { contentEl.style.maxHeight = contentEl.scrollHeight + 'px'; headerEl.classList.add('open'); updateParentMaxHeight(headerEl); }
Â  Â  }
Â  Â  function updateParentMaxHeight(el){
Â  Â  Â  let cur = el.parentElement;
Â  Â  Â  while (cur && cur.classList.contains('collapsible-content')){
Â  Â  Â  Â  if (cur.previousElementSibling?.classList.contains('teacher-header')) cur.style.maxHeight = cur.scrollHeight + 'px';
Â  Â  Â  Â  cur = cur.parentElement;
Â  Â  Â  }
Â  Â  }

Â  Â  function closeFlyout(){
Â  Â  Â  flyoutEl.classList.remove('show');
Â  Â  Â  setTimeout(()=>{ flyoutEl.style.display='none'; }, 200);
Â  Â  Â  if (activeCategoryHeader){ activeCategoryHeader.classList.remove('active'); activeCategoryHeader=null; }
Â  Â  }

Â  Â  function handleCategoryClick(e){
Â  Â  Â  e.stopPropagation();
Â  Â  Â  const headerEl = e.currentTarget;
Â  Â  Â  const videos = JSON.parse(headerEl.dataset.videos);
Â  Â  Â  const categoryName = headerEl.textContent.trim();
Â  Â  Â  const teacherName = headerEl.dataset.teacher || '';

Â  Â  Â  flyoutBreadcrumbEl.textContent = teacherName ? `${teacherName} â€º ${categoryName}` : categoryName;
Â  Â  Â  flyoutHeaderTextEl.textContent = categoryName;
Â  Â  Â  flyoutListEl.innerHTML = '';

Â  Â  Â  videos.forEach(v=>{
Â  Â  Â  Â  const li = document.createElement('li');
Â  Â  Â  Â  li.textContent = v.title;
Â  Â  Â  Â  li.dataset.videoId = v.id;
Â  Â  Â  Â  li.addEventListener('click', handleVideoClick);
Â  Â  Â  Â  flyoutListEl.appendChild(li);
Â  Â  Â  });

Â  Â  Â  document.querySelectorAll('.collapsible-header').forEach(h=>h.classList.remove('active'));
Â  Â  Â  headerEl.classList.add('active');
Â  Â  Â  activeCategoryHeader = headerEl;
Â  Â  Â  flyoutEl.style.display='block';
Â  Â  Â  setTimeout(()=>{ flyoutEl.classList.add('show'); }, 10);
Â  Â  }

Â  Â  function handleVideoClick(e){
Â  Â  Â  const newId = e.currentTarget.dataset.videoId;
Â  Â  Â  pendingVideoId = newId;
Â  Â  Â  if (!isPlayerReady){
Â  Â  Â  Â  // highlight selection; will cue when API becomes ready
Â  Â  Â  Â  document.querySelectorAll('#flyoutList li').forEach(li=>li.classList.remove('selected'));
Â  Â  Â  Â  e.currentTarget.classList.add('selected');
Â  Â  Â  Â  return;
Â  Â  Â  }
Â  Â  Â  player.cueVideoById(newId);
Â  Â  Â  finishedEl.style.display='none';
Â  Â  Â  controlsEl.style.display='flex';
Â  Â  Â  playPauseBtn.textContent='â–¶';
Â  Â  Â  seekRange.value=0;
Â  Â  Â  document.querySelectorAll('#flyoutList li').forEach(li=>li.classList.remove('selected'));
Â  Â  Â  e.currentTarget.classList.add('selected');
Â  Â  Â  closeFlyout();
Â  Â  }

Â  Â  document.addEventListener('click', (e)=>{
Â  Â  Â  const inFlyout = flyoutEl.contains(e.target);
Â  Â  Â  const inSidebar = document.getElementById('sidebar').contains(e.target);
Â  Â  Â  if (flyoutEl.style.display !== 'none' && !inFlyout && !inSidebar) closeFlyout();
Â  Â  });

Â  Â  closeFlyoutBtn?.addEventListener('click', closeFlyout);

Â  Â  // Boot
Â  Â  addEventListener('contextmenu', e=>e.preventDefault());
Â  Â  addEventListener('keydown', e=>{ const blocked=['ArrowLeft','ArrowRight','c','m']; if (blocked.includes(e.key.toLowerCase())){ e.preventDefault(); e.stopPropagation(); } }, {passive:false});
Â  Â  loadLocalData();
Â  </script>
</body>
</html>
